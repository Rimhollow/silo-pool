<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Store::TsmExecutor
  
    &mdash; Silo Service
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (T)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Store.html" title="Store (module)">Store</a></span></span>
     &raquo; 
    <span class="title">TsmExecutor</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Store::TsmExecutor
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Store::TsmExecutor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb</dd>
  
</dl>
<div class="clear"></div>



  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#command-instance_method" title="#command (instance method)">- (Object) <strong>command</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute command.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#dsmc-instance_method" title="#dsmc (instance method)">- (Object) <strong>dsmc</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute dsmc.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#pid-instance_method" title="#pid (instance method)">- (Object) <strong>pid</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute pid.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#server-instance_method" title="#server (instance method)">- (Object) <strong>server</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute server.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">- (Object) <strong>status</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute status.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tsm_path-class_method" title="tsm_path (class method)">+ (Object) <strong>tsm_path</strong>(pathname) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Deprecated:.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#errors-instance_method" title="#errors (instance method)">- (Object) <strong>errors</strong>(&amp;blk) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#handle_file-instance_method" title="#handle_file (instance method)">- (Object) <strong>handle_file</strong>(fio, &amp;blk) </a>
    

    
  </span>
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (TsmExecutor) <strong>initialize</strong>(servername, timeout = nil) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Store::TsmExecutor.new SERVERNAME, [ TIMEOUT ].</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#list-instance_method" title="#list (instance method)">- (Object) <strong>list</strong>(path, timeout = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#output-instance_method" title="#output (instance method)">- (Object) <strong>output</strong>(&amp;blk) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restore-instance_method" title="#restore (instance method)">- (Object) <strong>restore</strong>(path, destination, timeout = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><ul><li>
<p>-latest just seems to make sense – oops - that returns inactive as
well.…</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#run_dsmc-instance_method" title="#run_dsmc (instance method)">- (Object) <strong>run_dsmc</strong>(timeout, *cmd) </a>
    

    
  </span>
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>We throw in our own status codes here:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save-instance_method" title="#save (instance method)">- (Object) <strong>save</strong>(path, timeout = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>def delete path, timeout = nil.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout-instance_method" title="#timeout (instance method)">- (Object) <strong>timeout</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>timeout returns the default timeout for the TsmExecutor#delete,
TsmExecutor#save, TsmExecutor#list and TsmExecutor#restore commands.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">- (Object) <strong>to_s</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Store::TsmExecutor (class)">TsmExecutor</a></span></tt>) <strong>initialize</strong>(servername, timeout = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Store::TsmExecutor.new SERVERNAME, [ TIMEOUT ]</p>

<pre class="code"><span class='A constant id'>A</span> <span class='pig identifier id'>pig</span> <span class='is identifier id'>is</span> <span class='a identifier id'>a</span> <span class='jolly identifier id'>jolly</span> <span class='compainion identifier id'>compainion</span><span class='comma token'>,</span>
<span class='Boar constant id'>Boar</span><span class='comma token'>,</span> <span class='sow identifier id'>sow</span><span class='comma token'>,</span> <span class='barrow identifier id'>barrow</span> <span class='or or kw'>or</span> <span class='gilt identifier id'>gilt</span><span class='minus op'>-</span><span class='minus op'>-</span>
<span class='A constant id'>A</span> <span class='pig identifier id'>pig</span> <span class='is identifier id'>is</span> <span class='a identifier id'>a</span> <span class='pal identifier id'>pal</span><span class='comma token'>,</span> <span class='who identifier id'>who</span><span class='string val'>'ll boost your morale,
Though mountains may topple and tilt.
When they'</span><span class='ve identifier id'>ve</span> <span class='blackballed identifier id'>blackballed</span><span class='comma token'>,</span> <span class='bamboozled identifier id'>bamboozled</span> <span class='and and kw'>and</span> <span class='burned identifier id'>burned</span> <span class='you identifier id'>you</span><span class='comma token'>,</span>
<span class='When constant id'>When</span> <span class='they identifier id'>they</span><span class='string val'>'ve turned on you Tory and Whig,
Though you may be thrown over by Tabby or Rover,
You'</span><span class='ll identifier id'>ll</span> <span class='never identifier id'>never</span> <span class='go identifier id'>go</span> <span class='wrong identifier id'>wrong</span> <span class='with identifier id'>with</span> <span class='a identifier id'>a</span> <span class='pig identifier id'>pig</span><span class='comma token'>,</span> <span class='a identifier id'>a</span> <span class='pig identifier id'>pig</span><span class='comma token'>,</span>
<span class='You constant id'>You</span><span class='string val'>'ll never go wrong with a pig!
</span></pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57
58
59</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 50</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span>  <span class='servername identifier id'>servername</span><span class='comma token'>,</span> <span class='timeout identifier id'>timeout</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='@dsmc ivar id'>@dsmc</span>    <span class='assign token'>=</span> <span class='string val'>'/usr/bin/dsmc'</span>
  <span class='@server ivar id'>@server</span>  <span class='assign token'>=</span> <span class='servername identifier id'>servername</span>
  <span class='@command ivar id'>@command</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  
  <span class='@default_timeout ivar id'>@default_timeout</span> <span class='assign token'>=</span> <span class='timeout identifier id'>timeout</span> <span class='orop op'>||</span> <span class='integer val'>3600</span>

  <span class='@errors_file ivar id'>@errors_file</span> <span class='assign token'>=</span> <span class='Tempfile constant id'>Tempfile</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='string val'>'dsm-errors'</span>
  <span class='@output_file ivar id'>@output_file</span> <span class='assign token'>=</span> <span class='Tempfile constant id'>Tempfile</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='string val'>'dsm-output'</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="command-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="command-instance_method">
  
    - (<tt>Object</tt>) <strong>command</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute command</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 35</span>

<span class='def def kw'>def</span> <span class='command identifier id'>command</span>
  <span class='@command ivar id'>@command</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="dsmc-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="dsmc-instance_method">
  
    - (<tt>Object</tt>) <strong>dsmc</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute dsmc</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 35</span>

<span class='def def kw'>def</span> <span class='dsmc identifier id'>dsmc</span>
  <span class='@dsmc ivar id'>@dsmc</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="pid-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="pid-instance_method">
  
    - (<tt>Object</tt>) <strong>pid</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute pid</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 35</span>

<span class='def def kw'>def</span> <span class='pid identifier id'>pid</span>
  <span class='@pid ivar id'>@pid</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="server-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="server-instance_method">
  
    - (<tt>Object</tt>) <strong>server</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute server</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 35</span>

<span class='def def kw'>def</span> <span class='server identifier id'>server</span>
  <span class='@server ivar id'>@server</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="status-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="status-instance_method">
  
    - (<tt>Object</tt>) <strong>status</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute status</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 35</span>

<span class='def def kw'>def</span> <span class='status identifier id'>status</span>
  <span class='@status ivar id'>@status</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="tsm_path-class_method">
  
    + (<tt>Object</tt>) <strong>tsm_path</strong>(pathname) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Deprecated:</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 67</span>

<span class='def def kw'>def</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='tsm_path identifier id'>tsm_path</span> <span class='pathname identifier id'>pathname</span>
  <span class='pathname identifier id'>pathname</span>    <span class='assign token'>=</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='expand_path identifier id'>expand_path</span><span class='lparen token'>(</span><span class='pathname identifier id'>pathname</span><span class='rparen token'>)</span>
  <span class='pathname identifier id'>pathname</span>   <span class='opasgn op'>+=</span> <span class='File constant id'>File</span><span class='colon2 op'>::</span><span class='SEPARATOR constant id'>SEPARATOR</span> <span class='if if_mod kw'>if</span> <span class='File constant id'>File</span><span class='dot token'>.</span><span class='directory? fid id'>directory?</span> <span class='pathname identifier id'>pathname</span>
  <span class='mount_point identifier id'>mount_point</span> <span class='assign token'>=</span> <span class='StoreUtils constant id'>StoreUtils</span><span class='dot token'>.</span><span class='disk_mount_point identifier id'>disk_mount_point</span><span class='lparen token'>(</span><span class='pathname identifier id'>pathname</span><span class='rparen token'>)</span>
  <span class='pathname identifier id'>pathname</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span> <span class='dregexp node'>%r{^#{mount_point}}</span><span class='comma token'>,</span> <span class='dstring node'>&quot;{#{mount_point}}&quot;</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="errors-instance_method">
  
    - (<tt>Object</tt>) <strong>errors</strong>(&amp;blk) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 184</span>

<span class='def def kw'>def</span> <span class='errors identifier id'>errors</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span>
  <span class='handle_file identifier id'>handle_file</span> <span class='@errors_file ivar id'>@errors_file</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="handle_file-instance_method">
  
    - (<tt>Object</tt>) <strong>handle_file</strong>(fio, &amp;blk)  <span class="extras">(private)</span>
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194
195
196
197
198
199</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 190</span>

<span class='def def kw'>def</span> <span class='handle_file identifier id'>handle_file</span> <span class='fio identifier id'>fio</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span>
  <span class='fio identifier id'>fio</span><span class='dot token'>.</span><span class='rewind identifier id'>rewind</span>
  <span class='if if kw'>if</span> <span class='blk identifier id'>blk</span>
    <span class='while while kw'>while</span> <span class='not not kw'>not</span> <span class='fio identifier id'>fio</span><span class='dot token'>.</span><span class='eof? fid id'>eof?</span>
      <span class='yield yield kw'>yield</span> <span class='fio identifier id'>fio</span><span class='dot token'>.</span><span class='readline identifier id'>readline</span><span class='dot token'>.</span><span class='chomp identifier id'>chomp</span>
    <span class='end end kw'>end</span>
  <span class='else else kw'>else</span>
    <span class='fio identifier id'>fio</span><span class='dot token'>.</span><span class='readlines identifier id'>readlines</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="list-instance_method">
  
    - (<tt>Object</tt>) <strong>list</strong>(path, timeout = nil) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 116</span>

<span class='def def kw'>def</span> <span class='list identifier id'>list</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='timeout identifier id'>timeout</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='run_dsmc identifier id'>run_dsmc</span><span class='lparen token'>(</span><span class='timeout identifier id'>timeout</span><span class='comma token'>,</span> <span class='dsmc identifier id'>dsmc</span><span class='comma token'>,</span> <span class='string val'>&quot;query&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;backup&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-detail&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-inactive&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-filesonly&quot;</span><span class='comma token'>,</span> <span class='dstring node'>&quot;-servername=#{server}&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-scrollprompt=no&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-subdir=yes&quot;</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='rparen token'>)</span>

  <span class='state identifier id'>state</span>   <span class='assign token'>=</span> <span class='symbol val'>:other</span>
  <span class='listing identifier id'>listing</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rec identifier id'>rec</span>     <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>   <span class='comment val'># scoping</span>

  <span class='return return kw'>return</span> <span class='listing identifier id'>listing</span> <span class='unless unless_mod kw'>unless</span> <span class='lparen token'>(</span><span class='status identifier id'>status</span> <span class='eq op'>==</span> <span class='integer val'>0</span> <span class='and and kw'>and</span> <span class='errors identifier id'>errors</span><span class='dot token'>.</span><span class='length identifier id'>length</span> <span class='eq op'>==</span> <span class='integer val'>0</span><span class='rparen token'>)</span>

  <span class='output identifier id'>output</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='line identifier id'>line</span><span class='bitor op'>|</span>

    <span class='comment val'># Typical lines we'll be parsing from the tivoli output:</span>
    <span class='comment val'>#</span>
    <span class='comment val'>#          Size      Backup Date        Mgmt Class A/I File</span>
    <span class='comment val'>#          ----      -----------        ---------- --- ----</span>
    <span class='comment val'>#          0  B  07/13/2010 02:15:05    PERMANENT   A  /daitssfs/023/000/.lock</span>
    <span class='comment val'>#             Modified: 07/12/2010 18:22:25  Accessed: 10/28/2009 16:50:30</span>
    <span class='comment val'># 19,251,200  B  03/02/2010 09:46:12    PERMANENT   A  /daitssfs/023/000/04a197ad3a00ee4bc98b78858ce4c/data</span>
    <span class='comment val'>#             Modified: 10/28/2009 16:50:30  Accessed: 02/25/2010 21:46:19</span>
    <span class='comment val'># ...</span>
    <span class='comment val'>#         25  B  03/02/2010 22:33:17    PERMANENT   I  /daitssfs/023/ffe/c6562ea1af5f439234428aca9495c/type</span>
    <span class='comment val'>#             Modified: 11/02/2009 08:49:15 Accessed: 11/03/2009 04:09:02</span>
    <span class='comment val'>#</span>
    <span class='comment val'># We want to parse the active backup file (marked A under A/I) and the following modified time, then</span>
    <span class='comment val'># wrap into a nice tight struct..</span>
    

    <span class='line identifier id'>line</span><span class='dot token'>.</span><span class='gsub! fid id'>gsub!</span><span class='lparen token'>(</span><span class='regexp val'>/^\s+/</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span>

    <span class='case case kw'>case</span> <span class='state identifier id'>state</span>    
    <span class='when when kw'>when</span> <span class='symbol val'>:other</span>      <span class='comment val'># size     # units    # date                # time                # mgmt class    </span>
      <span class='if if kw'>if</span> <span class='line identifier id'>line</span> <span class='match op'>=~</span> <span class='regexp val'>%r{^([\d,]+)\s+([A-Z]+)\s+(\d{2}/\d{2}/\d{4})\s+(\d{2}:\d{2}:\d{2})\s+([A-Za-z0-9_-]+)\s+([A-Z]+)\s+(/.*)$}</span> <span class='and and kw'>and</span> <span class='$6 nth_ref id'>$6</span> <span class='eq op'>==</span> <span class='string val'>'A'</span>
        <span class='path identifier id'>path</span> <span class='assign token'>=</span> <span class='$7 nth_ref id'>$7</span>
        <span class='size identifier id'>size</span> <span class='assign token'>=</span> <span class='$1 nth_ref id'>$1</span><span class='dot token'>.</span><span class='gsub identifier id'>gsub</span><span class='lparen token'>(</span><span class='string val'>','</span><span class='comma token'>,</span> <span class='string val'>''</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span>
        <span class='rec identifier id'>rec</span> <span class='assign token'>=</span> <span class='Struct constant id'>Struct</span><span class='colon2 op'>::</span><span class='TivoliRecord constant id'>TivoliRecord</span><span class='dot token'>.</span><span class='new identifier id'>new</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='size identifier id'>size</span><span class='comma token'>,</span> <span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
        <span class='state identifier id'>state</span> <span class='assign token'>=</span> <span class='symbol val'>:listing</span>
      <span class='end end kw'>end</span>
    <span class='when when kw'>when</span> <span class='symbol val'>:listing</span>                <span class='comment val'># modification date,  # time                            # access date,        # time</span>
      <span class='if if kw'>if</span> <span class='line identifier id'>line</span> <span class='match op'>=~</span> <span class='regexp val'>%r{^Modified:\s+(\d{2}/\d{2}/\d{4})\s+(\d{2}:\d{2}:\d{2})\s+Accessed:\s+(\d{2}/\d{2}/\d{4})\s+(\d{2}:\d{2}:\d{2})}</span>
        <span class='rec identifier id'>rec</span><span class='dot token'>.</span><span class='mtime identifier id'>mtime</span> <span class='assign token'>=</span> <span class='Time constant id'>Time</span><span class='dot token'>.</span><span class='parse identifier id'>parse</span><span class='lparen token'>(</span><span class='$1 nth_ref id'>$1</span> <span class='plus op'>+</span> <span class='string val'>' '</span> <span class='plus op'>+</span> <span class='$2 nth_ref id'>$2</span><span class='rparen token'>)</span>
        <span class='listing identifier id'>listing</span><span class='dot token'>.</span><span class='push identifier id'>push</span> <span class='rec identifier id'>rec</span>
        <span class='state identifier id'>state</span> <span class='assign token'>=</span> <span class='symbol val'>:other</span>
      <span class='end end kw'>end</span>
    <span class='end end kw'>end</span>  
  <span class='end end kw'>end</span>  

  <span class='return return kw'>return</span> <span class='listing identifier id'>listing</span><span class='dot token'>.</span><span class='sort identifier id'>sort</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='a identifier id'>a</span><span class='comma token'>,</span> <span class='b identifier id'>b</span><span class='bitor op'>|</span> <span class='a identifier id'>a</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='cmp op'>&lt;=&gt;</span> <span class='b identifier id'>b</span><span class='dot token'>.</span><span class='path identifier id'>path</span> <span class='rbrace token'>}</span>  
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="output-instance_method">
  
    - (<tt>Object</tt>) <strong>output</strong>(&amp;blk) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 180</span>

<span class='def def kw'>def</span> <span class='output identifier id'>output</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span>
  <span class='handle_file identifier id'>handle_file</span> <span class='@output_file ivar id'>@output_file</span><span class='comma token'>,</span> <span class='bitand op'>&amp;</span><span class='blk identifier id'>blk</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="restore-instance_method">
  
    - (<tt>Object</tt>) <strong>restore</strong>(path, destination, timeout = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <ul><li>
<p>-latest just seems to make sense – oops - that returns inactive as
well.…</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 174</span>

<span class='def def kw'>def</span> <span class='restore identifier id'>restore</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='destination identifier id'>destination</span><span class='comma token'>,</span> <span class='timeout identifier id'>timeout</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='comment val'>### run_dsmc(timeout, dsmc, &quot;restore&quot;, &quot;-latest&quot;, &quot;-replace=no&quot;, &quot;-filesonly&quot;, &quot;-servername=#{server}&quot;, &quot;-subdir=yes&quot;, path, destination)</span>

  <span class='run_dsmc identifier id'>run_dsmc</span><span class='lparen token'>(</span><span class='timeout identifier id'>timeout</span><span class='comma token'>,</span> <span class='dsmc identifier id'>dsmc</span><span class='comma token'>,</span> <span class='string val'>&quot;restore&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-replace=no&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-filesonly&quot;</span><span class='comma token'>,</span> <span class='dstring node'>&quot;-servername=#{server}&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-subdir=yes&quot;</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='destination identifier id'>destination</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run_dsmc-instance_method">
  
    - (<tt>Object</tt>) <strong>run_dsmc</strong>(timeout, *cmd)  <span class="extras">(private)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>We throw in our own status codes here:</p>

<p>255:  self-inflicted timeout error 254:  error in popen (bad args, for
example) 253:  something’s really odd.</p>

<p>From the IBM manual:</p>

<pre class="code"><span class='Status constant id'>Status</span> <span class='code identifier id'>code</span> <span class='integer val'>0</span><span class='colon op'>:</span> <span class='All constant id'>All</span> <span class='operations identifier id'>operations</span> <span class='completed identifier id'>completed</span> <span class='successfully identifier id'>successfully</span><span class='dot token'>.</span>

<span class='Status constant id'>Status</span> <span class='code identifier id'>code</span> <span class='integer val'>4</span><span class='colon op'>:</span>  <span class='The constant id'>The</span> <span class='operation identifier id'>operation</span> <span class='completed identifier id'>completed</span> <span class='successfully identifier id'>successfully</span><span class='comma token'>,</span> <span class='but identifier id'>but</span> <span class='some identifier id'>some</span> <span class='files identifier id'>files</span> <span class='were identifier id'>were</span> <span class='not not kw'>not</span>
<span class='processed identifier id'>processed</span><span class='dot token'>.</span> <span class='There constant id'>There</span> <span class='were identifier id'>were</span> <span class='no identifier id'>no</span> <span class='other identifier id'>other</span> <span class='errors identifier id'>errors</span> <span class='or or kw'>or</span> <span class='warnings identifier id'>warnings</span><span class='dot token'>.</span> <span class='This constant id'>This</span> <span class='return return kw'>return</span> <span class='code identifier id'>code</span> <span class='is identifier id'>is</span>
<span class='very identifier id'>very</span> <span class='common identifier id'>common</span><span class='dot token'>.</span> <span class='Files constant id'>Files</span> <span class='are identifier id'>are</span> <span class='not not kw'>not</span> <span class='processed identifier id'>processed</span> <span class='for for kw'>for</span> <span class='various identifier id'>various</span> <span class='reasons identifier id'>reasons</span><span class='dot token'>.</span> <span class='The constant id'>The</span> <span class='most identifier id'>most</span>
<span class='common identifier id'>common</span> <span class='reasons identifier id'>reasons</span> <span class='are identifier id'>are</span><span class='colon op'>:</span>

  <span class='mult op'>*</span> <span class='The constant id'>The</span> <span class='file identifier id'>file</span> <span class='satisfies identifier id'>satisfies</span> <span class='an identifier id'>an</span> <span class='entry identifier id'>entry</span> <span class='in in kw'>in</span> <span class='an identifier id'>an</span> <span class='exclude identifier id'>exclude</span> <span class='list identifier id'>list</span><span class='dot token'>.</span>

  <span class='mult op'>*</span> <span class='The constant id'>The</span> <span class='file identifier id'>file</span> <span class='was identifier id'>was</span> <span class='in in kw'>in</span> <span class='use identifier id'>use</span> <span class='by identifier id'>by</span> <span class='another identifier id'>another</span> <span class='application identifier id'>application</span> <span class='and and kw'>and</span> <span class='could identifier id'>could</span> <span class='not not kw'>not</span> <span class='be identifier id'>be</span> 
    <span class='accessed identifier id'>accessed</span> <span class='by identifier id'>by</span> <span class='the identifier id'>the</span> <span class='client identifier id'>client</span><span class='dot token'>.</span>

  <span class='mult op'>*</span> <span class='The constant id'>The</span> <span class='file identifier id'>file</span> <span class='changed identifier id'>changed</span> <span class='during identifier id'>during</span> <span class='the identifier id'>the</span> <span class='operation identifier id'>operation</span> <span class='to identifier id'>to</span> <span class='an identifier id'>an</span> <span class='extent identifier id'>extent</span> <span class='prohibited identifier id'>prohibited</span> <span class='by identifier id'>by</span>
    <span class='the identifier id'>the</span> <span class='copy identifier id'>copy</span> <span class='serialization identifier id'>serialization</span> <span class='attribute identifier id'>attribute</span><span class='dot token'>.</span> <span class='See constant id'>See</span> </pre>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 241</span>

<span class='def def kw'>def</span> <span class='run_dsmc identifier id'>run_dsmc</span> <span class='timeout identifier id'>timeout</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='cmd identifier id'>cmd</span>
  <span class='timeout identifier id'>timeout</span> <span class='opasgn op'>||=</span> <span class='@default_timeout ivar id'>@default_timeout</span> 
  <span class='@command ivar id'>@command</span>  <span class='assign token'>=</span> <span class='cmd identifier id'>cmd</span><span class='dot token'>.</span><span class='join identifier id'>join</span><span class='lparen token'>(</span><span class='string val'>' '</span><span class='rparen token'>)</span>
  <span class='@status ivar id'>@status</span>   <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='lbrack token'>[</span> <span class='@output_file ivar id'>@output_file</span><span class='comma token'>,</span> <span class='@errors_file ivar id'>@errors_file</span> <span class='rbrack token'>]</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span> <span class='bitor op'>|</span><span class='file identifier id'>file</span><span class='bitor op'>|</span> <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='rewind identifier id'>rewind</span><span class='semicolon token'>;</span>  <span class='file identifier id'>file</span><span class='dot token'>.</span><span class='truncate identifier id'>truncate</span><span class='lparen token'>(</span><span class='integer val'>0</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
  
  <span class='Timeout constant id'>Timeout</span><span class='dot token'>.</span><span class='timeout identifier id'>timeout</span><span class='lparen token'>(</span><span class='timeout identifier id'>timeout</span><span class='rparen token'>)</span> <span class='do do kw'>do</span>
    <span class='Open4 constant id'>Open4</span><span class='dot token'>.</span><span class='popen4 identifier id'>popen4</span><span class='lparen token'>(</span><span class='mult op'>*</span><span class='cmd identifier id'>cmd</span><span class='rparen token'>)</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='@pid ivar id'>@pid</span><span class='comma token'>,</span> <span class='process_in identifier id'>process_in</span><span class='comma token'>,</span> <span class='process_out identifier id'>process_out</span><span class='comma token'>,</span> <span class='process_err identifier id'>process_err</span><span class='bitor op'>|</span>
      <span class='output_thread identifier id'>output_thread</span> <span class='assign token'>=</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='lbrace token'>{</span> <span class='while while kw'>while</span> <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='process_out identifier id'>process_out</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span><span class='semicolon token'>;</span> <span class='@output_file ivar id'>@output_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span> <span class='data identifier id'>data</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span> <span class='rbrace token'>}</span>
      <span class='errors_thread identifier id'>errors_thread</span> <span class='assign token'>=</span> <span class='Thread constant id'>Thread</span><span class='dot token'>.</span><span class='new identifier id'>new</span> <span class='lbrace token'>{</span> <span class='while while kw'>while</span> <span class='data identifier id'>data</span> <span class='assign token'>=</span> <span class='process_err identifier id'>process_err</span><span class='dot token'>.</span><span class='gets identifier id'>gets</span><span class='semicolon token'>;</span> <span class='@errors_file ivar id'>@errors_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span> <span class='data identifier id'>data</span><span class='semicolon token'>;</span> <span class='end end kw'>end</span> <span class='rbrace token'>}</span>
      <span class='output_thread identifier id'>output_thread</span><span class='dot token'>.</span><span class='join identifier id'>join</span>
      <span class='errors_thread identifier id'>errors_thread</span><span class='dot token'>.</span><span class='join identifier id'>join</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
  
<span class='rescue rescue kw'>rescue</span> <span class='Timeout constant id'>Timeout</span><span class='colon2 op'>::</span><span class='Error constant id'>Error</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
  <span class='@status ivar id'>@status</span> <span class='assign token'>=</span> <span class='integer val'>-1</span>
  <span class='@errors_file ivar id'>@errors_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span>  <span class='dstring node'>&quot;Execution of #{dsmc} timed out after #{timeout} seconds.&quot;</span>
  <span class='begin begin kw'>begin</span> 
    <span class='Process constant id'>Process</span><span class='dot token'>.</span><span class='kill identifier id'>kill</span><span class='lparen token'>(</span><span class='integer val'>15</span><span class='comma token'>,</span> <span class='@pid ivar id'>@pid</span><span class='rparen token'>)</span> 
  <span class='rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e2 identifier id'>e2</span>
    <span class='@errors_file ivar id'>@errors_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span> <span class='dstring node'>&quot;The #{dsmc} process (process id #{@pid}) wasn't killable after a timeout: #{e2.message}.&quot;</span>
  <span class='end end kw'>end</span>

<span class='rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='e identifier id'>e</span>
  <span class='@status ivar id'>@status</span> <span class='assign token'>=</span> <span class='integer val'>-2</span>  
  <span class='@errors_file ivar id'>@errors_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span> <span class='dstring node'>&quot;Error in popen4: #{e.message}.&quot;</span>      

<span class='else else kw'>else</span>
  <span class='if if kw'>if</span> <span class='$? gvar id'>$?</span><span class='dot token'>.</span><span class='nil? fid id'>nil?</span>
    <span class='@status ivar id'>@status</span> <span class='assign token'>=</span> <span class='integer val'>-3</span>
    <span class='@errors_file ivar id'>@errors_file</span><span class='dot token'>.</span><span class='write identifier id'>write</span> <span class='dstring node'>&quot;Unknown error running #{dsmc} (can't happen).&quot;</span>
  <span class='end end kw'>end</span>
  
<span class='ensure ensure kw'>ensure</span>                    <span class='comment val'># get the original process exit status back; note: this re-maps our </span>
  <span class='@status ivar id'>@status</span> <span class='assign token'>=</span> <span class='$? gvar id'>$?</span><span class='dot token'>.</span><span class='to_i identifier id'>to_i</span> <span class='rshft op'>&gt;&gt;</span> <span class='integer val'>8</span>  <span class='comment val'># special codes: -1 =&gt; 255; -2 =&gt; 254, -3 =&gt; 253</span>

<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save-instance_method">
  
    - (<tt>Object</tt>) <strong>save</strong>(path, timeout = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>def delete path, timeout = nil</p>

<pre class="code"><span class='run_dsmc identifier id'>run_dsmc</span><span class='lparen token'>(</span><span class='timeout identifier id'>timeout</span><span class='comma token'>,</span> <span class='dsmc identifier id'>dsmc</span><span class='comma token'>,</span> <span class='string val'>&quot;delete&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;backup&quot;</span><span class='comma token'>,</span>  <span class='string val'>&quot;-noprompt&quot;</span><span class='comma token'>,</span>  <span class='dstring node'>&quot;-servername=#{server}&quot;</span><span class='comma token'>,</span>  <span class='string val'>&quot;-subdir=yes&quot;</span><span class='comma token'>,</span>  <span class='path identifier id'>path</span><span class='rparen token'>)</span>
</pre>

<p>end</p>

<p>note on deletes from tape, which are now deprecated:</p>

<p>need do the two-pass delete as follows (need to be prepared for a 12
response code here on -deltype=inactive)</p>

<p>Me, on a condition noted in some test arrangements:</p>

<p>&gt;&gt; When I list I get what I expect.  When I extract I get more than I
&gt;&gt; expect; some files that should have been deleted.   What’s going
on?</p>

<p>Darryl:</p>

<p>&gt; Question:  Would there have been more than one version of those files
&gt; backed up?  By default, delete backup only deletes the active version,
&gt; and then your restore command, since it uses “-latest”, would then
&gt; see that the active version had been deleted and would thus restore
&gt; the inactive version with the newest date.  If this is the case, then
&gt; to delete all versions of a file, first issue the delete backup with
&gt; -deltype=inactive, then issue the command again with -deltype=active.
&gt; That’s the only way to guarantee all versions of a file are deleted.
&gt; &gt; Darryl &gt;</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


109
110
111
112</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 109</span>

<span class='def def kw'>def</span> <span class='save identifier id'>save</span> <span class='path identifier id'>path</span><span class='comma token'>,</span> <span class='timeout identifier id'>timeout</span> <span class='assign token'>=</span> <span class='nil nil kw'>nil</span>
  <span class='run_dsmc identifier id'>run_dsmc</span><span class='lparen token'>(</span><span class='timeout identifier id'>timeout</span><span class='comma token'>,</span> <span class='dsmc identifier id'>dsmc</span><span class='comma token'>,</span> <span class='string val'>&quot;backup&quot;</span><span class='comma token'>,</span> <span class='dstring node'>&quot;-servername=#{server}&quot;</span><span class='comma token'>,</span> <span class='string val'>&quot;-subdir=yes&quot;</span><span class='comma token'>,</span> <span class='path identifier id'>path</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='TsmExecutor constant id'>TsmExecutor</span><span class='dot token'>.</span><span class='tsm_path identifier id'>tsm_path</span><span class='lparen token'>(</span><span class='path identifier id'>path</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout-instance_method">
  
    - (<tt>Object</tt>) <strong>timeout</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>timeout returns the default timeout for the TsmExecutor#delete,
TsmExecutor#save, TsmExecutor#list and TsmExecutor#restore commands.  It is
optionally set on object creation.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 77</span>

<span class='def def kw'>def</span> <span class='timeout identifier id'>timeout</span>
  <span class='@default_timeout ivar id'>@default_timeout</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_s-instance_method">
  
    - (<tt>Object</tt>) <strong>to_s</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


61
62
63</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File '/Users/fischer/WorkProjects/daitss2/silo-pool/lib/store/tsmexecutor.rb', line 61</span>

<span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span>
  <span class='dstring node'>&quot;#&lt;#{@dsmc}: server #{@server}, last command: #{@command}&gt;&quot;</span>
<span class='end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Mon Nov 21 17:48:17 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.8.7).
</div>

  </body>
</html>